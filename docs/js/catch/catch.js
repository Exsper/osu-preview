function Catch(t){Beatmap.call(this,t);for(var t=window.localStorage.getItem("DefaultColor"),e=(this.useDefaultColor=t?parseInt(t):0,this.Colors.length&&!this.useDefaultColor?this.Colors.push(this.Colors.shift()):this.Colors=Catch.DEFAULT_COLORS,this.circleRadius=this.circleDiameter/2-4,this.smallRadius=this.circleRadius/2,this.tinyRadius=this.smallRadius/2,this.bananaRadius=.8*this.circleRadius,this.CATCHER_HEIGHT=Beatmap.HEIGHT/8,this.FALLOUT_TIME=this.CATCHER_HEIGHT/Beatmap.HEIGHT*this.approachTime,1),i=-1,a=1,s=0;s<this.HitObjects.length;s++){var h=this.HitObjects[s];h instanceof BananaShower?a=1:(h.newCombo||a)&&(i=(i+(e=1)+h.comboSkip)%this.Colors.length,a=0),h.combo=e++,h.color=this.Colors[i],(h instanceof JuiceStream||h instanceof BananaShower)&&h.buildNested()}this.CATCHER_BASE_SIZE=106.75,this.ALLOWED_CATCH_RANGE=.8,this.HYPER_DASH_TRANSITION_DURATION=180,this.calculateScale=1-.7*(this.CircleSize-5)/5,this.catchWidth=this.CATCHER_BASE_SIZE*Math.abs(this.calculateScale)*this.ALLOWED_CATCH_RANGE,this.halfCatcherWidth=this.catchWidth/2,this.halfCatcherWidth/=this.ALLOWED_CATCH_RANGE,this.BASE_DASH_SPEED=1,this.BASE_WALK_SPEED=.5,this.RNG_SEED=1337;for(var c=new LegacyRandom(this.RNG_SEED),s=0;s<this.HitObjects.length;s++){var l=this.HitObjects[s];l instanceof BananaShower?l.nested.forEach(t=>{t.x+=c.NextDouble()*Beatmap.MAX_X,c.Next(),c.Next(),c.Next()}):l instanceof JuiceStream&&l.nested.forEach(t=>{"TinyDroplet"===t.type?t.x+=Math.clamp(c.Next(-20,20),-t.x,Beatmap.MAX_X-t.x):"Droplet"===t.type&&c.Next()})}this.palpableObjects=[],this.fullCatchObjects=[];for(s=0;s<this.HitObjects.length;s++){var r,o=this.HitObjects[s];o instanceof Fruit?(r=new PalpableCatchHitObject({type:"Fruit",time:o.time,x:o.position.x,color:o.color,radius:this.circleRadius},this),this.palpableObjects.push(r),this.fullCatchObjects.push(r)):o instanceof BananaShower?o.nested.forEach(t=>{this.fullCatchObjects.push(t)}):o instanceof JuiceStream&&o.nested.forEach(t=>{this.fullCatchObjects.push(t),"TinyDroplet"!=t.type&&this.palpableObjects.push(t)}),this.palpableObjects.sort((t,e)=>t.time-e.time),this.fullCatchObjects.sort((t,e)=>t.time-e.time);let e=0,i=this.halfCatcherWidth;for(let t=0;t<this.palpableObjects.length-1;t++){var p=this.palpableObjects[t],n=this.palpableObjects[t+1],C=(p.hyperDash=!1,n.x>p.x?1:-1),f=n.time-p.time-1e3/60/4,n=Math.abs(n.x-p.x)-(e==C?i:this.halfCatcherWidth),f=f*this.BASE_DASH_SPEED-n;i=f<0?(p.hyperDash=!0,this.halfCatcherWidth):Math.clamp(f,0,this.halfCatcherWidth),e=C}}}Catch.prototype=Object.create(Beatmap.prototype,{approachTime:{get:function(){return this.ApproachRate<5?1800-120*this.ApproachRate:1200-150*(this.ApproachRate-5)}},circleDiameter:{get:function(){return 108.848-8.9646*this.CircleSize}}}),(Catch.prototype.constructor=Catch).prototype.hitObjectTypes={},Catch.ID=2,(Beatmap.modes[Catch.ID]=Catch).DEFAULT_COLORS=["rgb(255,210,128)","rgb(128,255,128)","rgb(128,191,255)","rgb(191,128,255)"],Catch.prototype.update=function(t){t.translate((Beatmap.WIDTH-Beatmap.MAX_X)/2,(Beatmap.HEIGHT-Beatmap.MAX_Y)/2)},Catch.prototype.draw=function(t,e){for(void 0===this.tmp.first&&(this.tmp.first=0,this.tmp.last=-1);this.tmp.first<this.fullCatchObjects.length;){if(t<=(i=this.fullCatchObjects[this.tmp.first]).time+this.FALLOUT_TIME)break;this.tmp.first++}for(;this.tmp.last+1<this.fullCatchObjects.length&&t>=this.fullCatchObjects[this.tmp.last+1].time-1.1*this.approachTime;)this.tmp.last++;for(var i,a=this.tmp.last;a>=this.tmp.first;a--)t>(i=this.fullCatchObjects[a]).time+this.FALLOUT_TIME||i.draw(t,e)},Catch.prototype.processBG=function(t){t.beginPath(),t.moveTo(0,Beatmap.HEIGHT-this.CATCHER_HEIGHT),t.lineTo(Beatmap.WIDTH,Beatmap.HEIGHT-this.CATCHER_HEIGHT),t.strokeStyle="#fff",t.lineWidth=2,t.stroke();t.beginPath(),t.rect(Beatmap.WIDTH/2-this.CATCHER_BASE_SIZE/2,Beatmap.HEIGHT-this.CATCHER_HEIGHT-2,this.CATCHER_BASE_SIZE,4),t.strokeStyle="#fff",t.lineWidth=8,t.stroke(),t.fillStyle="#fff",t.fill()};